<div class="table-section" id="disbursementTableSection">
    <h3>Disbursement Report</h3>
    <table id="employeesTable">
        <thead>
            <tr>
                <th>Disbursement ID</th>
                <th>Amount</th>
                <th>Disbursement Date</th>
                <th>Status</th>
                <th>Description</th>
                <th>Approver ID</th>
                <th>Payment Method ID</th>
                <th>Project ID</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody id="employeesTableBody">
            <?php if(!empty($disbursementReports)):
            foreach($disbursementReports as $row): ?>
            <tr>
                <td><?php echo htmlspecialchars($row['disbursement_id']);?></td>
                <td><?php echo htmlspecialchars($row['amount']);?></td>
                <td><?php echo htmlspecialchars($row['disbursement_date']);?></td>
                <td><?php echo htmlspecialchars($row['status']);?></td>
                <td><?php echo htmlspecialchars($row['description']);?></td>
                <td><?php echo htmlspecialchars($row['approver_id']);?></td>
                <td><?php echo htmlspecialchars($row['payment_method_id']);?></td>
                <td><?php echo htmlspecialchars($row['project_id']);?></td>
                <td>
                    <a href="#"
                       onclick="openViewModal(
                           '<?php echo $row['disbursement_id'];?>',
                           '<?php echo htmlspecialchars($row['amount'], ENT_QUOTES);?>',
                           '<?php echo htmlspecialchars($row['disbursement_date'], ENT_QUOTES);?>',
                           '<?php echo htmlspecialchars($row['status'], ENT_QUOTES);?>',
                           '<?php echo htmlspecialchars($row['description'], ENT_QUOTES);?>',
                           '<?php echo htmlspecialchars($row['approver_id'], ENT_QUOTES);?>',
                           '<?php echo htmlspecialchars($row['payment_method_id'], ENT_QUOTES);?>',
                           '<?php echo htmlspecialchars($row['project_id'], ENT_QUOTES);?>');
                       return false;">
                       üëÅÔ∏è View
                    </a>
                    <a href="#"
                       onclick="openUpdateModal(
                           '<?php echo $row['disbursement_id'];?>',
                           '<?php echo htmlspecialchars($row['amount'], ENT_QUOTES);?>',
                           '<?php echo htmlspecialchars($row['disbursement_date'], ENT_QUOTES);?>',
                           '<?php echo htmlspecialchars($row['status'], ENT_QUOTES);?>',
                           '<?php echo htmlspecialchars($row['description'], ENT_QUOTES);?>',
                           '<?php echo htmlspecialchars($row['approver_id'], ENT_QUOTES);?>',
                           '<?php echo htmlspecialchars($row['payment_method_id'], ENT_QUOTES);?>',
                           '<?php echo htmlspecialchars($row['project_id'], ENT_QUOTES);?>');
                       return false;">
                       ‚úèÔ∏è Update
                    </a>
                    <a href="#"
                       onclick="openArchiveModal('<?php echo $row['disbursement_id']?>'); return false;">
                       üóÑÔ∏è Archive
                    </a>
                </td>
            </tr>
            <?php endforeach; else:?>
            <tr><td colspan="9" class="text-center p-4">NO Records Found.</td></tr>
            <?php endif;?>
        </tbody>
    </table>
</div>

<div id="viewModal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center" onclick="outsideClick(event, 'viewModal')">
    <div class="bg-white p-6 rounded-lg shadow-lg w-1/3 relative" onclick="event.stopPropagation()">
        <h2 class="text-lg font-bold mb-4">View Disbursement</h2>
        <div class="space-y-2">
            <p><strong>Disbursement ID:</strong> <span id="viewDisbursementId"></span></p>
            <p><strong>Amount:</strong> <span id="viewAmount"></span></p>
            <p><strong>Disbursement Date:</strong> <span id="viewDisbursementDate"></span></p>
            <p><strong>Status:</strong> <span id="viewStatus"></span></p>
            <p><strong>Description:</strong> <span id="viewDescription"></span></p>
            <p><strong>Approver ID:</strong> <span id="viewApproverId"></span></p>
            <p><strong>Payment Method ID:</strong> <span id="viewPaymentMethodId"></span></p>
            <p><strong>Project ID:</strong> <span id="viewProjectId"></span></p>
        </div>
        <button class="mt-4 px-4 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400" onclick="closeModal('viewModal')">Close</button>
    </div>
</div>

<div id="updateModal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center" onclick="outsideClick(event, 'updateModal')">
    <div class="bg-white p-6 rounded-lg shadow-lg w-1/3 relative" onclick="event.stopPropagation()">
        <button class="absolute top-2 right-2 text-gray-500 hover:text-black" onclick="closeModal('updateModal')">&times;</button>
        <h2 class="text-lg font-bold mb-4">Update Disbursement</h2>
        <form method="post">
            <input type="hidden" name="update_disbursement_id" id="updateDisbursementId">
            <div class="space-y-4">
                <div>
                    <label for="updateAmount" class="block text-gray-700">Amount:</label>
                    <input type="number" name="update_amount" id="updateAmount" class="w-full p-2 border rounded" required>
                    <label for="updateDisbursementDate" class="block text-gray-700">Disbursement Date:</label>
                    <input type="date" name="update_disbursement_date" id="updateDisbursementDate" class="w-full p-2 border rounded" required>
                    <label for="updateStatus" class="block text-gray-700">Status:</label>
                    <input type="text" name="update_status" id="updateStatus" class="w-full p-2 border rounded" required>
                    <label for="updateDescription" class="block text-gray-700">Description:</label>
                    <input type="text" name="update_description" id="updateDescription" class="w-full p-2 border rounded" required>
                    <label for="updateApproverId" class="block text-gray-700">Approver ID:</label>
                    <input type="number" name="update_approver_id" id="updateApproverId" class="w-full p-2 border rounded" required>
                    <label for="updatePaymentMethodId" class="block text-gray-700">Payment Method ID:</label>
                    <input type="number" name="update_payment_method_id" id="updatePaymentMethodId" class="w-full p-2 border rounded" required>
                    <label for="updateProjectId" class="block text-gray-700">Project ID:</label>
                    <input type="number" name="update_project_id" id="updateProjectId" class="w-full p-2 border rounded" required>
                </div>
            </div>
            <div class="flex justify-end space-x-3 mt-4">
                <button type="button" class="px-4 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400" onclick="closeModal('updateModal')">Cancel</button>
                <button type="submit" name="update" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">Update</button>
            </div>
        </form>
    </div>
</div>

<div id="archiveModal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center" onclick="outsideClick(event, 'archiveModal')">
    <div class="bg-white p-6 rounded-lg shadow-lg w-1/3 relative" onclick="event.stopPropagation()">
        <button class="absolute top-2 right-2 text-gray-500 hover:text-black" onclick="closeModal('archiveModal')">&times;</button>
        <h2 class="text-lg font-bold mb-4">Archive Disbursement</h2>
        <p>Are you sure you want to archive this disbursement record?</p>
        <form method="post">
            <div class="flex justify-end space-x-3 mt-4">
                <input type="hidden" name="archive_disbursement_id" id="archiveDisbursementId">
                <button type="submit" name="archive" class="px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700">Archive</button>
                <button type="button" class="px-4 py-2 bg-gray-300 text-gray-700 rounded hover:bg-gray-400" onclick="closeModal('archiveModal')">Cancel</button>
            </div>
        </form>
    </div>
</div>

<script>
function openViewModal(disbursementId, amount, disbursementDate, status, description, approverId, paymentMethodId, projectId) {
    document.getElementById('viewDisbursementId').innerText = disbursementId;
    document.getElementById('viewAmount').innerText = amount;
    document.getElementById('viewDisbursementDate').innerText = disbursementDate;
    document.getElementById('viewStatus').innerText = status;
    document.getElementById('viewDescription').innerText = description;
    document.getElementById('viewApproverId').innerText = approverId;
    document.getElementById('viewPaymentMethodId').innerText = paymentMethodId;
    document.getElementById('viewProjectId').innerText = projectId;
    document.getElementById('viewModal').classList.remove('hidden');
}
function openUpdateModal(disbursementId, amount, disbursementDate, status, description, approverId, paymentMethodId, projectId) {
    document.getElementById('updateDisbursementId').value = disbursementId;
    document.getElementById('updateAmount').value = amount;
    document.getElementById('updateDisbursementDate').value = disbursementDate;
    document.getElementById('updateStatus').value = status;
    document.getElementById('updateDescription').value = description;
    document.getElementById('updateApproverId').value = approverId;
    document.getElementById('updatePaymentMethodId').value = paymentMethodId;
    document.getElementById('updateProjectId').value = projectId;
    document.getElementById('updateModal').classList.remove('hidden');
}
function openArchiveModal(disbursementId) {
    document.getElementById('archiveDisbursementId').value = disbursementId;
    document.getElementById('archiveModal').classList.remove('hidden');
}
function closeModal(modalId) {
    document.getElementById(modalId).classList.add('hidden');
}
function outsideClick(event, modalId) {
    if (event.target.id === modalId) {
        closeModal(modalId);
    }
}
</script>
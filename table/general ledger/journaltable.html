<!-- ====== Journal Entries Table ====== -->
<div class="table-section" id="invoiceTableSection">
  <h3 class="text-xl font-bold mb-4">Journal Entries Record</h3>
  <table id="employeesTable" >
    <thead >
      <tr>
        <th >Journal ID</th>
        <th >Date</th>
        <th >Description</th>
        <th >Reference Type</th>
        <th >Created By</th>
        <th >Action</th>
      </tr>
    </thead>
    <tbody id="employeesTableBody">
      <?php if(!empty($journals)):
      foreach($journals as $row): ?>
      <tr>
        <td ><?php echo htmlspecialchars($row['journalID']); ?></td>
        <td><?php echo htmlspecialchars($row['date']); ?></td>
        <td ><?php echo htmlspecialchars($row['description']); ?></td>
        <td ><?php echo htmlspecialchars($row['referenceType']); ?></td>
        <td ><?php echo htmlspecialchars($row['createdBy']); ?></td>
        <td >
          <!-- View -->
          <a href="#" 
             class=" hover:underline"
             onclick="openViewModal(
               '<?php echo $row['journalID']; ?>',
               '<?php echo htmlspecialchars($row['date'], ENT_QUOTES); ?>',
               '<?php echo htmlspecialchars($row['description'], ENT_QUOTES); ?>',
               '<?php echo htmlspecialchars($row['referenceType'], ENT_QUOTES); ?>',
               '<?php echo htmlspecialchars($row['createdBy'], ENT_QUOTES); ?>'
             ); return false;">
             üëÅÔ∏è View
          </a>
          <!-- Update -->
          <a href="#" 
             class="hover:underline"
             onclick="openUpdateModal(
               '<?php echo $row['journalID']; ?>',
               '<?php echo htmlspecialchars($row['date'], ENT_QUOTES); ?>',
               '<?php echo htmlspecialchars($row['description'], ENT_QUOTES); ?>',
               '<?php echo htmlspecialchars($row['referenceType'], ENT_QUOTES); ?>',
               '<?php echo htmlspecialchars($row['createdBy'], ENT_QUOTES); ?>'
             ); return false;">
             ‚úèÔ∏è Update
          </a>
          <!-- Archive -->
          <a href="#"
             class=" hover:underline"
             onclick="openArchiveModal('<?php echo $row['journalID']?>'); return false;">
             üóÑÔ∏è Archive
          </a>
        </td>
      </tr>
      <?php endforeach; else: ?>
      <tr><td colspan="6" class="text-center p-4">No records found.</td></tr>
      <?php endif; ?>
    </tbody>
  </table>
</div>

<!-- ====== View Modal ====== -->
<div id="viewModal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center" onclick="outsideClick(event, 'viewModal')">
  <div class="bg-white p-6 rounded-lg shadow-lg w-1/3 relative" onclick="event.stopPropagation()">
    <button class="absolute top-2 right-2 text-gray-500 hover:text-black" onclick="closeModal('viewModal')">&times;</button>
    <h2 class="text-lg font-bold mb-4">View Journal Entry</h2>
    <p><strong>Journal ID:</strong> <span id="viewJournalID"></span></p>
    <p><strong>Date:</strong> <span id="viewDate"></span></p>
    <p><strong>Description:</strong> <span id="viewDescription"></span></p>
    <p><strong>Reference Type:</strong> <span id="viewReferenceType"></span></p>
    <p><strong>Created By:</strong> <span id="viewCreatedBy"></span></p>
                 <button class="mt-4 px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600" onclick="closeModal('viewModal')">Close</button>
  </div>
</div>

<!-- ====== Update Modal ====== -->
<div id="updateModal" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center" onclick="outsideClick(event, 'updateModal')">
  <div class="bg-white p-6 rounded-lg shadow-lg w-1/3 relative" onclick="event.stopPropagation()">
    <button class="absolute top-2 right-2 text-gray-500 hover:text-black" onclick="closeModal('updateModal')">&times;</button>
    <h2 class="text-lg font-bold mb-4">Update Journal Entry</h2>
    <form method="post">
      
      <input type="hidden" name="journalID" id="updateJournalID">
         <div class="form-group">
      <label class="block mb-2">Date:</label>
      <input type="date" name="date" id="updateDate" class="border p-2 w-full mb-4" required>
      </div>   <div class="form-group">
      <label class="block mb-2">Description:</label>
      <input type="text" name="description" id="updateDescription" class="border p-2 w-full mb-4" required>
       </div>   <div class="form-group">
      <label class="block mb-2">Reference Type:</label>
      <input type="text" name="referenceType" id="updateReferenceType" class="border p-2 w-full mb-4" required>
       </div>   <div class="form-group">
      <label class="block mb-2">Created By:</label>
      <input type="text" name="createdBy" id="updateCreatedBy" class="border p-2 w-full mb-4" required>
      </div><div class="flex justify-end space-x-3">
      <button type="button" class="text-white px-4 py-2 bg-red-500 rounded-lg hover:bg-red-600" onclick="closeModal('updateModal')">Cancel</button>
        <button type="submit" name="update" class="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700">Update</button>
      </div>
    </form>
  </div>
  </div>
<!-- ====== Archive Modal ====== -->
<div id="archiveModal" class="hidden fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50" onclick="outsideclick(event, 'archiveModal')">
  <div class="bg-white rounded-2xl shadow-xl p-6 w-full max-w-sm relative">
    <button class="absolute top-3 right-3 text-gray-500 hover:text-gray-700 text-xl font-bold" onclick="closeModal('archiveModal')">&times;</button>
    <svg class="mx-auto mb-4 text-gray-400 w-12 h-12 dark:text-gray-200" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20">
                    <path stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 11V6m0 8h.01M19 10a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"/>
                </svg>
         <h2 class="text-lg font-bold mb-4 text-center">Archive Journal Entry</h2>
    <p>Are you sure you want to archive this journal entry?</p>
    <form method="post">
      <input type="hidden" name="archive_journalID" id="archiveJournalID">
      <div class="flex justify-end space-x-3">
       <button type="button" onclick="closeModal('archiveModal')" class="px-4 py-2 bg-blue-200 rounded-lg hover:bg-blue-300">Cancel</button>
                 <button type="submit" class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700" name="archive">Yes, Archive</button>
             </div>
    </form>
  </div>

</div>
<!-- ====== JS Functions ====== -->
<script>
function openViewModal(journalID, date, description, referenceType, createdBy) {
  document.getElementById('viewJournalID').innerText = journalID;
  document.getElementById('viewDate').innerText = date;
  document.getElementById('viewDescription').innerText = description;
  document.getElementById('viewReferenceType').innerText = referenceType;
  document.getElementById('viewCreatedBy').innerText = createdBy;
  document.getElementById('viewModal').classList.remove('hidden');
}

function openUpdateModal(journalID, date, description, referenceType, createdBy) {
  document.getElementById('updateJournalID').value = journalID;
  document.getElementById('updateDate').value = date;
  document.getElementById('updateDescription').value = description;
  document.getElementById('updateReferenceType').value = referenceType;
  document.getElementById('updateCreatedBy').value = createdBy;
  document.getElementById('updateModal').classList.remove('hidden');
}

function openArchiveModal(journalID) {
  document.getElementById('archiveJournalID').value = journalID;
  document.getElementById('archiveModal').classList.remove('hidden');
}

function closeModal(modalId) {
  document.getElementById(modalId).classList.add('hidden');
}

function outsideClick(event, modalId) {
  if (event.target.id === modalId) {
    closeModal(modalId);
  }
}
</script>
